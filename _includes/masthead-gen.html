<script>
  (async () => {

    const response = await fetch('https://api.github.com/repositories/304575824/contents/?ref=dev-v1');
    const dirData = await response.json();

    let htmlDirString = '<li><a href="/4m-association/">Home</a></li>';

    for(let dirFile of dirData){

        if((dirFile.type == 'dir') && ( !dirFile.name.startsWith('_')) && ( !dirFile.name.startsWith('.')) && ( dirFile.name != 'assets') && ( dirFile.name != 'contents') && ( dirFile.name != 'cookies') && ( dirFile.name != 'content') && ( dirFile.name != 'node') && ( dirFile.name != 'site_collections')){

            let reDirFileName = dirFile.name.replace(/([a-z0-9])([A-Z])/g, '$1 $2');
            reDirFileName = reDirFileName.replace(/([A-Za-z])([0-9])/g, '$1 $2');
            reDirFileName = reDirFileName.replace(/([A-Za-z0-9])([-])([a-z0-9])/g, '$1 $3');
            let capDirFileName = reDirFileName.replace(/(^\w{1})|(\s+\w{1})/g, letter => letter.toUpperCase());
            htmlDirString += '<li><a href="/4m-association/' + dirFile.path + '/">' + capDirFileName + '</a>';

            if(dirFile._links.self){

                htmlDirString += '<ul class="sub-menu">';
                let subResponse = await fetch(dirFile._links.self);
                let subDirData = await subResponse.json();

                for(let subDirFile of subDirData){

                    if(subDirFile.name != 'index.md'){
                        let subDirFileName = subDirFile.name;
                        if (subDirFileName.endsWith('.md')) {
                            subDirFileName = subDirFileName.slice(0, -3);
                        }
                        let subReDirFileName = subDirFileName.replace(/([a-z0-9])([A-Z])/g, '$1 $2');
                        subReDirFileName = subReDirFileName.replace(/([a-z])([0-9])/g, '$1 $2');
                        subReDirFileName = subReDirFileName.replace(/([a-z0-9])([-])([a-z0-9])/g, '$1 $3');
                        let capSubDirFileName = subReDirFileName.replace(/(^\w{1})|(\s+\w{1})/g, letter => letter.toUpperCase());
                        htmlDirString += '<li><a href="/4m-association/' + subDirFile.path + '/">' + capSubDirFileName + '</a></li>';
                    }
                }

                htmlDirString += '</ul>';
            }

            htmlDirString += '</li>';
        }
    }
    htmlDirString += '';

    document.getElementsByClassName('menu')[0].innerHTML = htmlDirString;
  })()
</script>